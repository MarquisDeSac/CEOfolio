---
---

<div class="fixed top-0 bottom-0 left-0 right-0 pointer-events-none print:hidden z-[-1] bg-white dark:bg-[#020205] transition-colors duration-500 overflow-hidden">
  <canvas id="starfield-canvas" class="w-full h-full"></canvas>
</div>

<script>
  function initStarfield() {
    const canvas = document.getElementById('starfield-canvas') as HTMLCanvasElement
    if (!canvas) return

    const ctx = canvas.getContext('2d')
    if (!ctx) return

    let width = window.innerWidth
    let height = window.innerHeight
    let centerX = width / 2
    let centerY = height / 2

    canvas.width = width
    canvas.height = height

    const stars: { x: number, y: number, z: number, o: number }[] = []
    const starCount = 400
    const speed = 0.5

    for (let i = 0; i < starCount; i++) {
      stars.push({
        x: (Math.random() - 0.5) * width * 2,
        y: (Math.random() - 0.5) * height * 2,
        z: Math.random() * width,
        o: Math.random()
      })
    }

    const DARK_BG = '#020205'
    const LIGHT_BG = '#ffffff'

    function draw() {
      // Clear canvas (background handles color)
      ctx.clearRect(0, 0, width, height)

      const isDark = document.documentElement.classList.contains('dark')

      for (const star of stars) {
        star.z -= speed

        if (star.z <= 0) {
          star.x = (Math.random() - 0.5) * width * 2
          star.y = (Math.random() - 0.5) * height * 2
          star.z = width
          star.o = Math.random()
        }

        const x = (star.x - centerX) * (width / star.z) + centerX
        const y = (star.y - centerY) * (width / star.z) + centerY
        const s = (width / star.z)

        // Light mode stars: Darker blue
        // Dark mode stars: Light blue/white
        const color = isDark ? `rgba(200, 220, 255, ${star.o})` : `rgba(20, 40, 100, ${star.o})`
        const glow = isDark ? 'rgba(60, 100, 255, 0.5)' : 'rgba(100, 150, 255, 0.3)'

        ctx.beginPath()
        ctx.fillStyle = color
        ctx.shadowBlur = s * 2
        ctx.shadowColor = glow
        ctx.arc(x, y, s < 0 ? 0 : s, 0, Math.PI * 2)
        ctx.fill()
        ctx.shadowBlur = 0
      }

      requestAnimationFrame(draw)
    }

      requestAnimationFrame(draw)
    }

    window.addEventListener('resize', () => {
      width = window.innerWidth
      height = window.innerHeight
      centerX = width / 2
      centerY = height / 2
      canvas.width = width
      canvas.height = height
    })

    draw()
  }

  document.addEventListener('astro:page-load', initStarfield)
  initStarfield()
</script>
